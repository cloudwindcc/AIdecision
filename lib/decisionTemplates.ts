export const decisionTemplates = {
  career: {
    prompt: `作为决策分析专家，请帮助用户进行职业决策分析。请按以下结构回复：

## 决策分析框架

### 1. 问题澄清
请确认以下关键信息：
- 当前职位和薪资水平
- 新机会的详细信息（职位、薪资、地点、公司文化）
- 个人职业目标和时间线
- 家庭和生活状况的影响

### 2. SWOT分析
基于用户提供的信息，生成详细的SWOT分析：

**优势 (Strengths)**
- [列出接受新机会的优势]

**劣势 (Weaknesses)**
- [列出潜在风险和劣势]

**机会 (Opportunities)**
- [长期职业发展机会]

**威胁 (Threats)**
- [可能面临的挑战和威胁]

### 3. 决策矩阵
创建一个评分矩阵（1-10分）：
| 因素 | 权重 | 当前工作 | 新机会 | 加权得分 |
|------|------|----------|--------|----------|
| 薪资福利 | 25% | [评分] | [评分] | [计算] |
| 职业发展 | 25% | [评分] | [评分] | [计算] |
| 工作生活平衡 | 20% | [评分] | [评分] | [计算] |
| 地点/通勤 | 15% | [评分] | [评分] | [计算] |
| 公司文化 | 15% | [评分] | [评分] | [计算] |

### 4. 情景分析
**最佳情况：**
- [描述如果一切顺利的发展路径]

**最糟情况：**
- [描述如果出现问题的影响]

**现实情况：**
- [基于统计数据的合理预期]

### 5. 行动建议
基于分析，提供：
1. **推荐选择**（附带置信度百分比）
2. **具体实施步骤**
3. **风险缓解措施**
4. **决策时间表**`
  },

  financial: {
    prompt: `作为财务决策专家，请帮助用户进行投资或重要财务决策分析。请按以下结构回复：

## 财务决策分析框架

### 1. 财务状况评估
请确认以下信息：
- 当前净资产状况
- 现金流情况
- 风险承受能力
- 投资时间跨度
- 流动性需求

### 2. 投资回报分析
**预期收益计算：**
- 保守估计：[数值]
- 乐观估计：[数值]
- 最可能情况：[数值]

**风险调整后收益：**
- 夏普比率分析
- 最大回撤评估
- 波动性考量

### 3. 投资组合影响
**当前资产配置：**
- [列出现有投资组合]

**投资后配置：**
- [展示投资后的新配置]

**多元化分析：**
- 相关性分析
- 集中度风险

### 4. 情景压力测试
**市场下跌20%情景：**
- [影响和应对策略]

**紧急资金需求情景：**
- [流动性影响和解决方案]

### 5. 税务优化建议
**税收影响分析：**
- [针对不同投资方式的税务对比]

### 6. 实施计划**
1. **投资执行步骤**
2. **定期回顾机制**
3. **退出策略**`
  },

  relationship: {
    prompt: `作为关系咨询专家，请帮助用户处理人际关系决策。请按以下结构回复：

## 人际关系决策分析框架

### 1. 关系现状评估
**关系类型识别：**
- [明确关系的性质和深度]

**关键问题澄清：**
- [确认用户面临的核心冲突]

**各方立场分析：**
- [用户立场]
- [对方立场]
- [潜在第三方影响]

### 2. 影响分析
**短期影响：**
- [不同选择的即时后果]

**长期影响：**
- [对关系的长期发展影响]
- [对个人成长的影响]

### 3. 沟通策略建议
**最佳沟通时机：**
- [时间和环境建议]

**沟通方式：**
- [具体对话策略]
- [情绪管理技巧]

### 4. 边界设定建议
**健康边界：**
- [需要设定的具体边界]

**执行策略：**
- [如何温和而坚定地执行]

### 5. 行动计划**
1. **准备阶段**
2. **沟通执行**
3. **后续跟进**`
  },

  health: {
    prompt: `作为健康管理顾问，请帮助用户进行健康相关决策分析。请按以下结构回复：

## 健康决策分析框架

### 1. 健康现状评估
**医疗信息确认：**
- [需要了解的健康背景]
- [当前治疗方案]
- [医生建议和依据]

### 2. 风险收益分析
**治疗选择对比：**
- 选择A：[收益与风险]
- 选择B：[收益与风险]
- 选择C：[收益与风险]

### 3. 生活质量影响
**日常活动影响：**
- [对不同生活方面的影响]

**长期预后：**
- [基于医学研究的预期结果]

### 4. 第二意见建议
**需要咨询的问题：**
- [向医生询问的关键问题]

**信息来源建议：**
- [可靠的健康信息资源]

### 5. 决策支持工具**
- [具体的决策辅助工具]
- [记录和监控方法]`
  },

  general: {
    prompt: `作为决策分析专家，请帮助用户进行通用决策分析。请按以下结构回复：

## 通用决策分析框架

### 1. 问题定义
**核心决策：**
- [明确用户需要做出的具体选择]

**决策约束：**
- [时间、资源、条件限制]

### 2. 信息收集
**已知信息：**
- [用户已掌握的信息]

**需要补充的信息：**
- [决策所需的关键缺失信息]

### 3. 选项生成
**可行选择：**
- 选项1：[描述]
- 选项2：[描述]
- 选项3：[描述]

### 4. 评估标准
**重要维度：**
- [列出评估的关键因素]

**权重分配：**
- [各因素的重要性权重]

### 5. 决策矩阵
创建评分矩阵并计算加权得分

### 6. 敏感性分析
**关键假设：**
- [识别最重要的假设条件]

**假设变化影响：**
- [如果关键假设变化的影响]

### 7. 实施建议**
1. **推荐选择**
2. **行动计划**
3. **监控指标**
4. **调整机制**`
  }
};

export function getDecisionPrompt(type: string, userMessage: string): string {
  const template = decisionTemplates[type as keyof typeof decisionTemplates] || decisionTemplates.general;
  return `${template.prompt}\n\n用户问题：${userMessage}\n\n请基于以上框架提供专业的决策分析：`;
}

export function detectDecisionType(message: string): string {
  const lowerMessage = message.toLowerCase();
  
  const keywords = {
    career: ['工作', '职位', '跳槽', '薪资', '升职', '辞职', '转行', 'offer', '面试'],
    financial: ['投资', '理财', '股票', '基金', '买房', '贷款', '存款', '预算', '赚钱'],
    relationship: ['分手', '表白', '结婚', '离婚', '朋友', '家人', '恋爱', '感情', '相处'],
    health: ['健康', '疾病', '治疗', '手术', '减肥', '健身', '饮食', '医院', '体检'],
    education: ['学习', '考研', '留学', '培训', '证书', '技能', '课程', '学校', '专业'],
    business: ['创业', '开店', '项目', '合作', '投资', '商业', '市场', '客户', '产品'],
    lifestyle: ['搬家', '旅行', '买车', '装修', '购物', '生活方式', '城市', '选择']
  };

  for (const [type, words] of Object.entries(keywords)) {
    if (words.some(word => lowerMessage.includes(word))) {
      return type;
    }
  }
  
  return 'general';
}